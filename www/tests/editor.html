<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Brython</title>
<link rel="stylesheet" href="/brython.css">
<link rel="stylesheet" href="console.css">

<script type="text/javascript" src="../src/brython_builtins.js"></script>
<script type="text/javascript" src="../src/version_info.js"></script>
<script type="text/javascript" src="../src/py2js.js"></script>
<script type="text/javascript" src="../src/loaders.js"></script>
<script type="text/javascript" src="../src/py_object.js"></script>
<script type="text/javascript" src="../src/py_type.js"></script>
<script type="text/javascript" src="../src/py_utils.js"></script>
<script type="text/javascript" src="../src/py_sort.js"></script>
<script type="text/javascript" src="../src/py_builtin_functions.js"></script>
<script type="text/javascript" src="../src/py_exceptions.js"></script>
<script type="text/javascript" src="../src/py_range_slice.js"></script>
<script type="text/javascript" src="../src/py_bytes.js"></script>
<script type="text/javascript" src="../src/py_set.js"></script>
<script type="text/javascript" src="../src/js_objects.js"></script>
<script type="text/javascript" src="../src/stdlib_paths.js"></script>
<script type="text/javascript" src="../src/py_import.js"></script>

<script type="text/javascript" src="../src/unicode_data.js"></script>
<script type="text/javascript" src="../src/py_string.js"></script>
<script type="text/javascript" src="../src/py_int.js"></script>
<script type="text/javascript" src="../src/py_long_int.js"></script>
<script type="text/javascript" src="../src/py_float.js"></script>
<script type="text/javascript" src="../src/py_complex.js"></script>
<script type="text/javascript" src="../src/py_dict.js"></script>
<script type="text/javascript" src="../src/py_list.js"></script>
<script type="text/javascript" src="../src/py_generator.js"></script>
<script type="text/javascript" src="../src/py_dom.js"></script>

<script type="text/javascript" src="../src/builtin_modules.js"></script>
<script type="text/javascript" src="../src/py_import_hooks.js"></script>
<script type="text/javascript" src="../src/async.js"></script>

<script type="text/javascript" src="../src/brython_stdlib.js"></script>

<script src="/assets/header.brython.js"></script>

<script src="ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="ace/ext-language_tools.js" type="text/javascript" charset="utf-8"></script>

<script type="text/python3" id="tests_editor">
from browser import document as doc, window
from browser import html
import header

import editor

qs_lang,language = header.show()

doc["test_suite"].href = f"index.html?lang={language}"
# other translations

trans = {
    'report_bugs':{'en':'Please report bugs in the ',
                   'es':'Poner los bugs en el ',
                   'fr':"Signalez les bugs dans l'"},
    'test_page':{'en':'Tests page','es':'P&aacute;gina de pruebas','fr':'Page de tests'},
    'run':{'en':'run','es':'ejecutar','fr':'Exécuter'},
    'clear':{'en':'clear','es':'borrar','fr':'Effacer'}
}

for key in trans:
    if key in doc:
        doc[key].html = trans[key].get(language,trans[key]['en'])

def set_debug(ev):
    if ev.target.checked:
        __BRYTHON__.debug = 1
    else:
        __BRYTHON__.debug = 0

__BRYTHON__.debug = int(doc['set_debug'].checked)

# bindings
doc['set_debug'].bind('change',set_debug)

# next functions are defined in editor.py
doc['show_js'].bind('click', editor.show_js)
doc['share_code'].bind('click', editor.share_code)
# Create a lambda around editor.run() so that the event object is not passed to it
doc['run'].bind('click',lambda *args: editor.run())
doc['show_console'].bind('click', editor.show_console)


window.loadThemes('theme_select')

</script>

<script>
function run_js(){
    var cons = document.getElementById("console")
    var jscode = cons.value
    var t0 = (new Date()).getTime()
    eval(jscode)
    var t1 = (new Date()).getTime()
    console.log("Javascript code run in "+(t1-t0)+" ms")
}
</script>
</head>
<body onload="brython({debug:1})">

<div id="banner_row">
<span class="logo"><a href="/index.html">brython</a></span>
</div>

<div id="main_container"></div>

</div>

<table id="container">
  <tr>
    <td>
      <label for="Themes">Theme:</label>
        <select id="theme_select" name="theme_select" onchange="themeSelectChenged();">
          <optgroup id="group_light" label="Light"></optgroup>
          <optgroup id="group_dark" label="Dark"></optgroup>
        </select>

        <label for="FontSize">Font Size:</label>
        <input type="number" id="fontsize" min="8" max="34" value="12" onchange="fontSizeChanged();">
    </td>
    <td></td>
    <td>
        <button id="run"> ▶ Run</button>
        Debug<input type="checkbox" id="set_debug" checked>
        <button id="show_console">Python</button>
        <button id="show_js">Javascript</button>
        <button id="share_code">Share code</button>
    </td>
  </tr>

  <tr>
    <td id="left">
      <div id="editor" style="width:100%;"></div>
    </td>
    <td id="separator"></td>
    <td id="right">
      <textarea id="console" autocomplete="off"></textarea>
    </td>
  </tr>

  <tr>
    <td>
      Brython version: <span id="version"></span> 
      : Python code editor uses <a href="https://ace.c9.io/" target="_blank">Ace</a>.
    </td>
    <td></td>
    <td>
      <a href="#" id="test_suite">Tests suite</a>
    </td>
  </tr>
</table>


<script>

var themeData = [
    ["Chrome"         ],
    ["Clouds"         ],
    ["Crimson Editor" ],
    ["Dawn"           ],
    ["Dreamweaver"    ],
    ["Eclipse"        ],
    ["GitHub"         ],
    ["IPlastic"       ],
    ["Solarized Light"],
    ["TextMate"       ],
    ["Tomorrow"       ],
    ["Xcode"          ],
    ["Kuroir"],
    ["KatzenMilch"],
    ["SQL Server"           ,"sqlserver"               , "light"],
    ["Ambiance"             ,"ambiance"                ,  "dark"],
    ["Chaos"                ,"chaos"                   ,  "dark"],
    ["Clouds Midnight"      ,"clouds_midnight"         ,  "dark"],
    ["Dracula"              ,""                        ,  "dark"],
    ["Cobalt"               ,"cobalt"                  ,  "dark"],
    ["Gruvbox"              ,"gruvbox"                 ,  "dark"],
    ["Green on Black"       ,"gob"                     ,  "dark"],
    ["idle Fingers"         ,"idle_fingers"            ,  "dark"],
    ["krTheme"              ,"kr_theme"                ,  "dark"],
    ["Merbivore"            ,"merbivore"               ,  "dark"],
    ["Merbivore Soft"       ,"merbivore_soft"          ,  "dark"],
    ["Mono Industrial"      ,"mono_industrial"         ,  "dark"],
    ["Monokai"              ,"monokai"                 ,  "dark"],
    ["Nord Dark"            ,"nord_dark"               ,  "dark"],
    ["Pastel on dark"       ,"pastel_on_dark"          ,  "dark"],
    ["Solarized Dark"       ,"solarized_dark"          ,  "dark"],
    ["Terminal"             ,"terminal"                ,  "dark"],
    ["Tomorrow Night"       ,"tomorrow_night"          ,  "dark"],
    ["Tomorrow Night Blue"  ,"tomorrow_night_blue"     ,  "dark"],
    ["Tomorrow Night Bright","tomorrow_night_bright"   ,  "dark"],
    ["Tomorrow Night 80s"   ,"tomorrow_night_eighties" ,  "dark"],
    ["Twilight"             ,"twilight"                ,  "dark"],
    ["Vibrant Ink"          ,"vibrant_ink"             ,  "dark"]
];

function loadThemes(selectid){
  // set the initial theme data 
  var DEFAULT_THEME = "ace/theme/solarized_light"
  var DEFAULT_FONT_SIZE = '14'

  fillThemeData(selectid,themeData)

  //set the default font size 
  document.getElementById('editor').style.fontSize=DEFAULT_FONT_SIZE+"px"

  // set default dropdown list value
  document.getElementById(selectid).value = DEFAULT_THEME
  
  //update the theme to set it to the default
  themeSelectChenged()

  //set the fone size to the default
  fontSizeChanged()

}

function fillThemeData(id, options){

  themesByName = {}

  var light = document.getElementById("group_light");
  var dark = document.getElementById("group_dark");
  
  //create a themes array
  themes = options.map(function(data) {
    
    var name = data[1] || data[0].replace(/ /g, "_").toLowerCase()
    var theme = {
        caption: data[0],
        theme: "ace/theme/" + name,
        isDark: data[2] == "dark",
        name: name
    };
    themesByName[name] = theme
    return theme
    
  });
  
 //fill the drop down list with theme data
  for(var i=0;i<themes.length;i++)
  {
    var opt = themes[i].caption;
    var val = themes[i].theme
     
    var el = document.createElement("option");
    el.textContent = opt;
    el.value = val;

    if(themes[i].isDark == true) 
      dark.appendChild(el);
    else
      light.appendChild(el);
  }
  
}

function themeSelectChenged()
{
  var e = document.getElementById("theme_select");
  var value = e.options[e.selectedIndex].value;
  var text = e.options[e.selectedIndex].text;
  var editor = ace.edit("editor");
  editor.setTheme(value);
}

function fontSizeChanged()
{
  size = parseInt(document.getElementById("fontsize").value);
  document.getElementById('editor').style.fontSize=size+"px";
}

</script>

</body>
</html>
